{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/jakecasey/Documents/Projects/Bugs/skeleton-key-frontend/components/special/ShowPins.js\";\nimport { Global as globalState } from \"./Global\";\nimport React, { Component } from \"react\";\nimport { Subscribe } from \"unstated\";\nimport styled from \"styled-components\";\nimport SickButton from \"../styles/SickButton\";\nimport Pin from \"./Pin\";\nimport withContainers from \"../wrappers/withContainer\";\nimport { waitForIframeScrollPosition } from \"../../lib/helpers\";\nconst ShowPinsDiv = styled.div.withConfig({\n  displayName: \"ShowPins__ShowPinsDiv\",\n  componentId: \"sc-1acb6tt-0\"\n})([\"position:absolute;top:\", \";left:0px;right:0px;bottom:0px;z-index:2;pointer-events:none;\"], props => props.scrollTop ? props.scrollTop : \"0px\");\nvar timeout = \"\";\n\nclass ShowPins extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      scrollTop: 0\n    });\n\n    _defineProperty(this, \"_updateScrollPosition\", event => {\n      console.log(\"update scroll position\");\n      var scroll = \"\";\n      var iframeScrollPosition = document.getElementById(\"iframe\").contentWindow.document.getElementById(\"iframeScrollPosition\");\n\n      if (iframeScrollPosition.getAttribute(\"y\")) {\n        scroll = -iframeScrollPosition.getAttribute(\"y\");\n      } else {\n        scroll = 0;\n      }\n\n      this.setState({\n        scrollTop: scroll + \"px\"\n      });\n    });\n\n    _defineProperty(this, \"_handleScroll\", me => {\n      console.log(\"Scroll listener.\");\n      window.clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        this._updateScrollPosition();\n\n        setTimeout(this._updateScrollPosition(), 150);\n      }, 200);\n\n      this._updateScrollPosition();\n    });\n  }\n\n  componentDidMount() {\n    //get initial scroll pos\n    //TODO: THIS NEEDS TO WAIT FOR IFRAME TO EXIST\n    waitForIframeScrollPosition(document, () => {\n      this._updateScrollPosition(); //attach scroll listener\n\n\n      document.getElementById(\"iframe\").contentWindow.document.addEventListener(\"scroll\", this._handleScroll, false);\n    });\n    let interval = setInterval(() => {\n      let element = document.getElementById(\"iframe\").contentWindow.document.getElementById(\"iframeScrollPosition\");\n      console.log(\"running interval\");\n\n      if (typeof element !== \"undefined\") {\n        clearInterval(interval);\n        console.log(\"Interval cleared\");\n\n        this._updateScrollPosition(); //attach scroll listener\n\n\n        document.getElementById(\"iframe\").contentWindow.document.addEventListener(\"scroll\", this._handleScroll, false);\n      }\n    }, 500); // console.log(\n    //   document\n    //     .getElementById(\"iframe\")\n    //     .contentWindow.document.getElementById(\"iframeScrollPosition\")\n    // );\n    // setTimeout(() => {\n    //   this._updateScrollPosition();\n    //   //attach scroll listener\n    //   document\n    //     .getElementById(\"iframe\")\n    //     .contentWindow.document.addEventListener(\n    //       \"scroll\",\n    //       this._handleScroll,\n    //       false\n    //     );\n    // }, 2000);\n  } //polling is almost accurate but needs a trail off perhaps an interval or a while statement\n  //that runs several more times over a few seconds.\n\n\n  componentWillUnmount() {// window.removeEventListener('scroll', this._updateScrollPosition, false);\n  }\n\n  render() {\n    var block = this.props.block;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(Subscribe, {\n      to: [globalState],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, test => React.createElement(ShowPinsDiv, {\n      scrollTop: this.state.scrollTop,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, test.state.pins.map((pin, i) => {\n      return React.createElement(Pin, {\n        key: i,\n        pin: pin,\n        test: test,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      });\n    }))));\n  }\n\n} // export default withContainers([globalState])(ShowPins);\n\n\nexport default ShowPins;","map":{"version":3,"sources":["/Users/jakecasey/Documents/Projects/Bugs/skeleton-key-frontend/components/special/ShowPins.js"],"names":["Global","globalState","React","Component","Subscribe","styled","SickButton","Pin","withContainers","waitForIframeScrollPosition","ShowPinsDiv","div","props","scrollTop","timeout","ShowPins","event","console","log","scroll","iframeScrollPosition","document","getElementById","contentWindow","getAttribute","setState","me","window","clearTimeout","setTimeout","_updateScrollPosition","componentDidMount","addEventListener","_handleScroll","interval","setInterval","element","clearInterval","componentWillUnmount","render","block","test","state","pins","map","pin","i"],"mappings":"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","sourcesContent":["import { Global as globalState } from \"./Global\";\nimport React, { Component } from \"react\";\nimport { Subscribe } from \"unstated\";\n\nimport styled from \"styled-components\";\n\nimport SickButton from \"../styles/SickButton\";\nimport Pin from \"./Pin\";\nimport withContainers from \"../wrappers/withContainer\";\nimport { waitForIframeScrollPosition } from \"../../lib/helpers\";\n\nconst ShowPinsDiv = styled.div`\n  position: absolute;\n  top: ${props => (props.scrollTop ? props.scrollTop : \"0px\")};\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  z-index: 2;\n  pointer-events: none;\n`;\n\nvar timeout = \"\";\n\nclass ShowPins extends Component {\n  state = {\n    scrollTop: 0\n  };\n\n  componentDidMount() {\n    //get initial scroll pos\n\n    //TODO: THIS NEEDS TO WAIT FOR IFRAME TO EXIST\n\n    waitForIframeScrollPosition(document, () => {\n      this._updateScrollPosition();\n      //attach scroll listener\n      document\n        .getElementById(\"iframe\")\n        .contentWindow.document.addEventListener(\n          \"scroll\",\n          this._handleScroll,\n          false\n        );\n    });\n\n    let interval = setInterval(() => {\n      let element = document\n        .getElementById(\"iframe\")\n        .contentWindow.document.getElementById(\"iframeScrollPosition\");\n\n      console.log(\"running interval\");\n\n      if (typeof element !== \"undefined\") {\n        clearInterval(interval);\n        console.log(\"Interval cleared\");\n        this._updateScrollPosition();\n        //attach scroll listener\n        document\n          .getElementById(\"iframe\")\n          .contentWindow.document.addEventListener(\n            \"scroll\",\n            this._handleScroll,\n            false\n          );\n      }\n    }, 500);\n\n    // console.log(\n    //   document\n    //     .getElementById(\"iframe\")\n    //     .contentWindow.document.getElementById(\"iframeScrollPosition\")\n    // );\n\n    // setTimeout(() => {\n    //   this._updateScrollPosition();\n    //   //attach scroll listener\n    //   document\n    //     .getElementById(\"iframe\")\n    //     .contentWindow.document.addEventListener(\n    //       \"scroll\",\n    //       this._handleScroll,\n    //       false\n    //     );\n    // }, 2000);\n  }\n\n  //polling is almost accurate but needs a trail off perhaps an interval or a while statement\n  //that runs several more times over a few seconds.\n\n  _updateScrollPosition = event => {\n    console.log(\"update scroll position\");\n    var scroll = \"\";\n    var iframeScrollPosition = document\n      .getElementById(\"iframe\")\n      .contentWindow.document.getElementById(\"iframeScrollPosition\");\n\n    if (iframeScrollPosition.getAttribute(\"y\")) {\n      scroll = -iframeScrollPosition.getAttribute(\"y\");\n    } else {\n      scroll = 0;\n    }\n\n    this.setState({ scrollTop: scroll + \"px\" });\n  };\n\n  _handleScroll = me => {\n    console.log(\"Scroll listener.\");\n    window.clearTimeout(timeout);\n    timeout = setTimeout(() => {\n      this._updateScrollPosition();\n      setTimeout(this._updateScrollPosition(), 150);\n    }, 200);\n    this._updateScrollPosition();\n  };\n\n  componentWillUnmount() {\n    // window.removeEventListener('scroll', this._updateScrollPosition, false);\n  }\n  render() {\n    var block = this.props.block;\n    return (\n      <div>\n        <Subscribe to={[globalState]}>\n          {test => (\n            <ShowPinsDiv scrollTop={this.state.scrollTop}>\n              {test.state.pins.map((pin, i) => {\n                return <Pin key={i} pin={pin} test={test} />;\n              })}\n            </ShowPinsDiv>\n          )}\n        </Subscribe>\n      </div>\n    );\n  }\n}\n\n// export default withContainers([globalState])(ShowPins);\nexport default ShowPins;\n"]},"metadata":{},"sourceType":"module"}