{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Fragment } from \"react\";\nimport { Container, Subscribe } from \"unstated\";\nimport PinOverlay from \"./PinOverlay\";\nimport ShowPins from \"./ShowPins\";\nimport shortId from \"shortid\";\nimport _ from \"lodash\";\nimport { frontend, prodFrontend } from \"../../config\";\nimport { endpoint, prodEndPoint } from \"../../config\";\nvar backendUrl = process.env.NODE_ENV === \"development\" ? endpoint : prodEndPoint;\nvar frontendUrl = process.env.NODE_ENV === \"development\" ? frontend : prodFrontend;\n\nvar Global =\n/*#__PURE__*/\nfunction (_Container) {\n  _inherits(Global, _Container);\n\n  function Global() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Global);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Global)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      overIframe: [],\n      urlSelected: backendUrl + \"/api/screenshot?url=http://bugherd.com\",\n      pageLoading: true,\n      showPins: true,\n      showCanvas: false,\n      canvas: null,\n      iframe: {\n        size: {\n          height: 0,\n          width: 200\n        }\n      },\n      showToolbarOverlay: false,\n      toolbarOverlayContents: \"\",\n      toolbar: [],\n      isPlacingPin: false,\n      pins: []\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addSimpleTextBlock\", function () {\n      // 1. Make the overlay disappear.\n      _this.toggleToolbarOverlay(); // 2. Build our simple text block.\n\n\n      var simpleText = {\n        id: shortId.generate(),\n        type: \"text\",\n        value: \"test\",\n        label: \"test\"\n      }; // 3. Add it to our toolbar.\n\n      var toolbar = _this.state.toolbar;\n      toolbar.push(simpleText);\n\n      _this.setState({\n        toolbar: toolbar\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateTextBlock\", function (textBlock) {\n      var value = textBlock.value,\n          label = textBlock.label,\n          id = textBlock.id;\n      var simpleText = _this.state.toolbar[id];\n\n      _this.setState({\n        toolbar: _toConsumableArray(simpleText)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addPinBlock\", function () {\n      _this.toggleToolbarOverlay();\n\n      _this.setState({\n        overIframe: [].concat(_toConsumableArray(_this.state.overIframe), [{\n          belongsTo: \"test\",\n          component: ShowPins\n        }])\n      });\n\n      var pin = {\n        id: shortId.generate(),\n        type: \"pin\"\n      }; //place pin view over iframe\n\n      var toolbar = _this.state.toolbar;\n      toolbar.push(pin);\n\n      _this.setState({\n        toolbar: toolbar\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"putComponentInToolbar\", function (component) {\n      _this.setState({\n        toolbarOverlayContents: component\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleToolbarOverlay\", function () {\n      _this.setState({\n        showToolbarOverlay: !_this.state.showToolbarOverlay\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"togglePinPlacement\", function (id, block) {\n      if (_this.state.isPlacingPin) {\n        var stat = _this.state.overIframe;\n        stat = _.filter(stat, function (i) {\n          return i.belongsTo != id;\n        });\n\n        _this.setState({\n          overIframe: stat,\n          isPlacingPin: false\n        });\n      } else {\n        _this.setState({\n          overIframe: [].concat(_toConsumableArray(_this.state.overIframe), [{\n            belongsTo: id,\n            component: PinOverlay\n          }]),\n          isPlacingPin: true\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addPath\", function () {\n      var canvas = _this.state.canvas;\n      var path = new fabric.Path(\"M 0 0 L 200 100 L 170 200 z\");\n      path.set({\n        left: 120,\n        top: 120\n      });\n      canvas.add(path);\n\n      _this.setState({\n        canvas: canvas\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addArrow\", function () {\n      var canvas = _this.state.canvas;\n      fabric.loadSVGFromURL(\"/static/images/arrow.svg\", function (objects, options) {\n        var obj = fabric.util.groupSVGElements(objects, options);\n        canvas.add(obj).renderAll();\n      });\n\n      _this.setState({\n        canvas: canvas\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showCanvas\", function () {\n      _this.setState({\n        showCanvas: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"hideCanvas\", function () {\n      _this.setState({\n        showCanvas: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"instantiateCanvas\", function (that) {\n      var canvas = new fabric.Canvas(that.c);\n\n      _this.setState({\n        canvas: canvas\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"clear\", function () {\n      var canvas = _this.state.canvas;\n      var canvas = canvas.clear();\n\n      _this.setState({\n        canvas: canvas\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_placePin\", function (pin) {\n      pin.id = shortId.generate();\n      var pins = _this.state.pins;\n      pins.push(pin);\n\n      _this.setState({\n        pins: pins\n      });\n\n      console.log(\"Pin placed.\");\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_updatePinCommentByID\", function (id, text, previousState) {\n      var that = previousState;\n      _.find(that, {\n        id: id\n      }).comment = text;\n\n      _this.setState({\n        pins: that\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_loadStateFromHash\", function (hash) {\n      var hash = atob(hash);\n      var previousState = _this.state;\n      hash = JSON.parse(hash);\n      console.log(\"Hash loaded.\");\n\n      if (hash.pins.length > 0) {\n        previousState.overIframe = [{\n          belongsTo: \"test\",\n          component: ShowPins\n        }];\n      }\n\n      previousState.pins = _.cloneDeep(hash.pins);\n      previousState.toolbar = hash.toolbar;\n      previousState.urlSelected = hash.urlSelected;\n      previousState.isPlacingPin = false;\n      previousState.pageLoading = true;\n\n      _this.setState(_objectSpread({}, previousState));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"resetUI\", function () {\n      _this.setState({\n        overIframe: [],\n        pageLoading: true,\n        showPins: true,\n        showCanvas: false,\n        canvas: null,\n        iframe: {\n          size: {\n            height: 0,\n            width: 200\n          }\n        },\n        showToolbarOverlay: false,\n        toolbarOverlayContents: \"\",\n        toolbar: [],\n        isPlacingPin: false,\n        pins: []\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fetchPage\", function (url) {\n      _this.resetUI();\n\n      _this.setState({\n        pageLoading: true,\n        urlSelected: backendUrl + \"/api/screenshot?url=\" + url\n      });\n    });\n\n    return _this;\n  }\n\n  return Global;\n}(Container);\n\nexport { Global };","map":{"version":3,"sources":["/Users/jakecasey/Documents/Projects/Bugs/skeleton-key-frontend/components/special/Global.js"],"names":["React","Fragment","Container","Subscribe","PinOverlay","ShowPins","shortId","_","frontend","prodFrontend","endpoint","prodEndPoint","backendUrl","process","env","NODE_ENV","frontendUrl","Global","overIframe","urlSelected","pageLoading","showPins","showCanvas","canvas","iframe","size","height","width","showToolbarOverlay","toolbarOverlayContents","toolbar","isPlacingPin","pins","toggleToolbarOverlay","simpleText","id","generate","type","value","label","state","push","setState","textBlock","belongsTo","component","pin","block","stat","filter","i","path","fabric","Path","set","left","top","add","loadSVGFromURL","objects","options","obj","util","groupSVGElements","renderAll","that","Canvas","c","clear","console","log","text","previousState","find","comment","hash","atob","JSON","parse","length","cloneDeep","url","resetUI"],"mappings":"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","sourcesContent":["import React, { Fragment } from \"react\";\nimport { Container, Subscribe } from \"unstated\";\nimport PinOverlay from \"./PinOverlay\";\nimport ShowPins from \"./ShowPins\";\nimport shortId from \"shortid\";\nimport _ from \"lodash\";\nimport { frontend, prodFrontend } from \"../../config\";\nimport { endpoint, prodEndPoint } from \"../../config\";\n\nconst backendUrl =\n  process.env.NODE_ENV === \"development\" ? endpoint : prodEndPoint;\nvar frontendUrl =\n  process.env.NODE_ENV === \"development\" ? frontend : prodFrontend;\n\nclass Global extends Container {\n  state = {\n    overIframe: [],\n    urlSelected: backendUrl + \"/api/screenshot?url=http://bugherd.com\",\n    pageLoading: true,\n    showPins: true,\n    showCanvas: false,\n    canvas: null,\n    iframe: {\n      size: { height: 0, width: 200 }\n    },\n    showToolbarOverlay: false,\n    toolbarOverlayContents: \"\",\n    toolbar: [],\n    isPlacingPin: false,\n    pins: []\n  };\n\n  addSimpleTextBlock = () => {\n    // 1. Make the overlay disappear.\n    this.toggleToolbarOverlay();\n\n    // 2. Build our simple text block.\n    var simpleText = {\n      id: shortId.generate(),\n      type: \"text\",\n      value: \"test\",\n      label: \"test\"\n    };\n\n    // 3. Add it to our toolbar.\n    var toolbar = this.state.toolbar;\n    toolbar.push(simpleText);\n\n    this.setState({ toolbar });\n  };\n\n  updateTextBlock = textBlock => {\n    let { value, label, id } = textBlock;\n    let simpleText = this.state.toolbar[id];\n    this.setState({ toolbar: [...simpleText] });\n  };\n\n  addPinBlock = () => {\n    this.toggleToolbarOverlay();\n\n    this.setState({\n      overIframe: [\n        ...this.state.overIframe,\n        { belongsTo: \"test\", component: ShowPins }\n      ]\n    });\n\n    var pin = {\n      id: shortId.generate(),\n      type: \"pin\"\n    };\n\n    //place pin view over iframe\n\n    var toolbar = this.state.toolbar;\n\n    toolbar.push(pin);\n\n    this.setState({ toolbar });\n  };\n\n  putComponentInToolbar = component => {\n    this.setState({ toolbarOverlayContents: component });\n  };\n\n  toggleToolbarOverlay = () => {\n    this.setState({ showToolbarOverlay: !this.state.showToolbarOverlay });\n  };\n\n  togglePinPlacement = (id, block) => {\n    if (this.state.isPlacingPin) {\n      var stat = this.state.overIframe;\n\n      stat = _.filter(stat, function(i) {\n        return i.belongsTo != id;\n      });\n\n      this.setState({\n        overIframe: stat,\n        isPlacingPin: false\n      });\n    } else {\n      this.setState({\n        overIframe: [\n          ...this.state.overIframe,\n          { belongsTo: id, component: PinOverlay }\n        ],\n        isPlacingPin: true\n      });\n    }\n  };\n\n  addPath = () => {\n    var canvas = this.state.canvas;\n    var path = new fabric.Path(\"M 0 0 L 200 100 L 170 200 z\");\n    path.set({ left: 120, top: 120 });\n    canvas.add(path);\n    this.setState({ canvas });\n  };\n\n  addArrow = () => {\n    var canvas = this.state.canvas;\n    fabric.loadSVGFromURL(\"/static/images/arrow.svg\", function(\n      objects,\n      options\n    ) {\n      var obj = fabric.util.groupSVGElements(objects, options);\n      canvas.add(obj).renderAll();\n    });\n    this.setState({ canvas });\n  };\n\n  showCanvas = () => {\n    this.setState({ showCanvas: true });\n  };\n\n  hideCanvas = () => {\n    this.setState({ showCanvas: false });\n  };\n\n  instantiateCanvas = that => {\n    const canvas = new fabric.Canvas(that.c);\n    this.setState({ canvas });\n  };\n\n  clear = () => {\n    var canvas = this.state.canvas;\n    var canvas = canvas.clear();\n    this.setState({ canvas });\n  };\n\n  _placePin = pin => {\n    pin.id = shortId.generate();\n    var pins = this.state.pins;\n    pins.push(pin);\n    this.setState({ pins });\n\n    console.log(\"Pin placed.\");\n  };\n\n  _updatePinCommentByID = (id, text, previousState) => {\n    var that = previousState;\n    _.find(that, { id: id }).comment = text;\n    this.setState({ pins: that });\n  };\n\n  _loadStateFromHash = hash => {\n    var hash = atob(hash);\n    var previousState = this.state;\n    hash = JSON.parse(hash);\n    console.log(\"Hash loaded.\");\n\n    if (hash.pins.length > 0) {\n      previousState.overIframe = [\n        {\n          belongsTo: \"test\",\n          component: ShowPins\n        }\n      ];\n    }\n    previousState.pins = _.cloneDeep(hash.pins);\n    previousState.toolbar = hash.toolbar;\n\n    previousState.urlSelected = hash.urlSelected;\n    previousState.isPlacingPin = false;\n    previousState.pageLoading = true;\n    this.setState({ ...previousState });\n  };\n\n  resetUI = () => {\n    this.setState({\n      overIframe: [],\n      pageLoading: true,\n      showPins: true,\n      showCanvas: false,\n      canvas: null,\n      iframe: {\n        size: { height: 0, width: 200 }\n      },\n      showToolbarOverlay: false,\n      toolbarOverlayContents: \"\",\n      toolbar: [],\n      isPlacingPin: false,\n      pins: []\n    });\n  };\n\n  fetchPage = url => {\n    this.resetUI();\n    this.setState({\n      pageLoading: true,\n      urlSelected: backendUrl + \"/api/screenshot?url=\" + url\n    });\n  };\n}\n\nexport { Global };\n"]},"metadata":{},"sourceType":"module"}